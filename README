# react-native-mlkit-text-recognition

A cross-platform React Native bridge for Google MLKit Text Recognition (iOS v8.x & Android ML Kit v16.x)

## Installation

Install from npm:
```bash
yarn add react-native-mlkit-text-recognition
pod install --repo-update
```

### iOS

MLKitTextRecognitionCommon includes an embargoed domain (nic.ir.md). This will result in app store rejections. Apply this patch to fix that until Google releases an update.

# === Top-level post_install ===
post_install do |installer|

# 1) Get the binary as a plain String
  bin_path = (installer.sandbox.root + 'MLKitTextRecognitionCommon/Frameworks/MLKitTextRecognitionCommon.framework/MLKitTextRecognitionCommon').to_s

  puts 'üîç Patching MLKitTextRecognitionCommon for embargoed domains‚Ä¶'

  patch_script = <<~BASH
    #!/usr/bin/env bash
    BINARY="#{bin_path}"
    if [ ! -f "$BINARY" ]; then
      echo "‚ö†Ô∏è  Binary not found at $BINARY, skipping patch."
      exit 0
    fi
    grep -aob 'nic\\.ir\\.md' "$BINARY" | \
    while IFS=: read -r offset match; do
      count=${#match}
      echo "  ‚Ä¢ Zeroing out $count bytes at offset $offset"
      dd if=/dev/zero bs=1 count=$count seek=$offset of="$BINARY" conv=notrunc >/dev/null 2>&1
    done

    FRAMEWORK_DIR="$(dirname "$BINARY")"
    IDENTITY="${CODE_SIGN_IDENTITY:--}"
    echo "üîë Re-signing MLKit at $FRAMEWORK_DIR with identity: $IDENTITY"
    codesign --force --sign "$IDENTITY" --preserve-metadata=identifier,entitlements "$FRAMEWORK_DIR"
  BASH

  system('bash', '-c', patch_script)

end

### Android

Untested
